# 镜像拉取（默认就是你这个仓库 owner；如果你 fork 了再改）
IMAGE_OWNER=zhongruan0522
IMAGE_TAG=latest

# 宿主机端口映射（给你自己的 Nginx/Caddy/Traefik 去反代用）
WEB_PORT=3000
BACKEND_PORT=8000

# Cookie 协议（影响浏览器是否能保存 Cookie）
# 默认 HTTPS；如果你用 IP 直连（HTTP）想让浏览器正常保存 Cookie，把它改成 HTTP
COOKIE_HTTP=HTTPS

# 可选：web 内部访问后端地址
# BACKEND_INTERNAL_URL=

# PostgreSQL（默认使用根目录 docker-compose.yml 自带的 postgres）
# 如果你用的是 `docker-compose.core.yml`（仅三件套），把下面的 host 改成 host.docker.internal / 你的内网地址即可
POSTGRES_USER=antihub
POSTGRES_PASSWORD=please-change-me
POSTGRES_DB=antihub
# 仅影响宿主机端口映射；容器内互联仍固定走 5432
# POSTGRES_PORT=5432

DATABASE_URL=postgresql+asyncpg://antihub:please-change-me@postgres:5432/antihub
# Plugin 的 DB_* 是容器内连接参数：
# - 用本项目自带 postgres：保持 PLUGIN_DB_HOST=postgres 且 PLUGIN_DB_PORT=5432（不要跟上面的 POSTGRES_PORT 一起改）
# - 用外部 PG：改成你的 host/port
PLUGIN_DB_HOST=postgres
PLUGIN_DB_PORT=5432
PLUGIN_DB_NAME=antigravity
PLUGIN_DB_USER=antigravity
PLUGIN_DB_PASSWORD=please-change-me

# Plugin DB → Backend DB 迁移（可选；默认关闭）
# 说明：
# - 用于将旧 AntiHub-plugin 的 accounts/model_quotas 导入到 Backend 的 antigravity_* 表
# - 开启后若迁移失败，Backend 会阻止启动（避免半迁移状态运行）
PLUGIN_DB_MIGRATION_ENABLED=false
# 仅迁移期需要：plugin DB 连接串（注意不是 Backend 的 DATABASE_URL）
PLUGIN_MIGRATION_DATABASE_URL=postgresql+asyncpg://antigravity:please-change-me@postgres:5432/antigravity

# Backend 必配
JWT_SECRET_KEY=please-change-me
PLUGIN_ADMIN_API_KEY=sk-admin-please-change-me
# 必须是 Fernet key（32字节 urlsafe base64），可用 AntiHub-Backend/generate_encryption_key.py 生成
# 以下是示例密钥，仅用于开发/测试，生产环境必须更换！
# 生成新密钥：docker compose run --rm backend python generate_encryption_key.py
PLUGIN_API_ENCRYPTION_KEY=STAdjfQFXLnk2-2Vd8WaGPr0OJ4h_Cvk91WCcpds7G8=

# Backend 调试（可选）
# 开启后会在后端日志里打印用户请求体（完整原始请求体），可能包含敏感信息；不要在生产环境开启
DEBUG_LOG=false

# CODEX_SUPPORTED_MODELS (optional)
# Override Codex model list returned by backend:
# - GET /api/codex/models
# - GET /v1/models (when X-Api-Type: codex)
# Format: JSON array OR comma-separated string.
# Note:
# - AntiHub 的 `/v1/responses/compact`（codex）会走 Codex upstream 的 `/responses/compact`
#   （默认 `https://chatgpt.com/backend-api/codex`，与 CLIProxyAPI 行为一致），可支持 `gpt-5.3-codex` 等 Codex-only 模型。
# - 如果你把 `CODEX_API_BASE_URL` 指向 OpenAI Platform 或其它“不支持 Codex 模型名”的上游，
#   仍可能报 “model does not exist / no access”。
# Example: CODEX_SUPPORTED_MODELS=["gpt-5.2-codex","gpt-5.2","gpt-5.1-codex-max","gpt-5.1-codex-mini","gpt-5.1-codex","gpt-5.1","gpt-5-codex-mini","gpt-5-codex","gpt-5"]
# 中文：可选覆盖 Codex 模型列表
# CODEX_SUPPORTED_MODELS=
#
# CODEX_API_BASE_URL (optional)
# Default: https://chatgpt.com/backend-api/codex
# CODEX_API_BASE_URL=
#
# CODEX_PROXY_URL (optional)
# Outbound proxy for Codex/OpenAI upstream requests. Example:
#   CODEX_PROXY_URL=http://host.docker.internal:7890
# CODEX_PROXY_URL=

# 管理员账号配置（可选，首次启动时自动创建）
# 如果不需要自动创建管理员，可以留空或删除这两行
ADMIN_USERNAME=admin
ADMIN_PASSWORD=please-change-me-to-strong-password

# Plugin OAuth（可选）
PLUGIN_OAUTH_CALLBACK_URL=

# Kiro IDE UA 版本（可选；默认内置 0.9.2）
# KIRO_IDE_VERSION=0.9.2

# Kiro usage limits 同步节流（可选）
# - 背景同步会调用上游 /getUsageLimits 拉取剩余额度；频率过高可能触发 429
# - 默认 300 秒同步一次；当遇到 429 时默认进入 300 秒冷却期
# - 如需关闭节流（不推荐，可能更容易 429），可设置为 0
# KIRO_USAGE_LIMITS_SYNC_INTERVAL_SECONDS=300
# KIRO_USAGE_LIMITS_429_COOLDOWN_SECONDS=300

# Gemini CLI OAuth（可选）
# 默认后端使用内置的“参考实现同款” OAuth 配置；如你需要自定义（例如用你自己的 GCP OAuth 客户端），在这里覆盖即可。
# GEMINI_CLI_OAUTH_CLIENT_ID=
# GEMINI_CLI_OAUTH_CLIENT_SECRET=
# GEMINI_CLI_OAUTH_REDIRECT_URI=http://localhost:8085/oauth2callback
# GEMINI_CLI_OAUTH_SCOPE=https://www.googleapis.com/auth/cloud-platform https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile

# Redis（默认使用 compose 自带 redis；如果你有现成的 Redis，可在这里覆盖）
# REDIS_URL=redis://host.docker.internal:6379/0
# PLUGIN_REDIS_HOST=host.docker.internal
# PLUGIN_REDIS_PORT=6379
# PLUGIN_REDIS_PASSWORD=

# ZAI TTS（可选）
# 非流式请求的音频文件会保存在后端 storage/tts，容器重启会自动清理；默认最多保留 10 个文件（可覆盖）
ZAI_TTS_BASE_URL=https://audio.z.ai
ZAI_TTS_FILE_KEEP_COUNT=10

# ZAI Image (optional)
ZAI_IMAGE_BASE_URL=https://image.z.ai
# ZAI_IMAGE_USER_AGENT=Mozilla/5.0 AppleWebKit/537.36 Chrome/143 Safari/537
